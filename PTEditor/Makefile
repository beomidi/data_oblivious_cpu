all: pteditor ptedit.o example header tests

header: module/pteditor.c module/pteditor.h ptedit.c ptedit.h
	echo "#pragma once" > ptedit_header.h
	cat module/pteditor.h ptedit.h ptedit.c | \
	sed -e 's/#include ".*"//g' -e "1i // Warning: this file was generated by make. DO NOT EDIT!" | sed 's/extern //g'| sed 's/#define ptedit_fnc/#define ptedit_fnc static/g' >> ptedit_header.h

pteditor: module/pteditor.c
	cd module && make

example: example.c header
	riscv64-unknown-linux-gnu-gcc -Wall -Wextra example.c -g -o example

demos: header pteditor
	cd demos && make

tests: header pteditor
	cd test && make

deb:
	dpkg-buildpackage

clean:
	cd module && make clean
	cd test && make clean
	rm -f example *.o
